"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getTextureDefinition = exports.writeExtension = exports.tryGetInArray = void 0;
function tryGetInArray(arr, index) {
    if (index === undefined)
        return null;
    if (Array.isArray(arr) && arr.length > index) {
        return arr[index];
    }
    return null;
}
exports.tryGetInArray = tryGetInArray;
function writeExtension(prop, name, ext) {
    if (prop === null)
        return;
    if (ext) {
        if (!prop.extensions) {
            prop.extensions = {};
        }
        prop.extensions[name] = ext;
    }
}
exports.writeExtension = writeExtension;
function getTextureDefinition(context, tex) {
    const textureDefinitions = context.jsonDoc.json.textures;
    if (!textureDefinitions)
        return;
    // we use the texture image map to find the texture definition to write the extension to
    const textureImageIndexMap = context.imageIndexMap;
    // get the image this texture is using
    const imageIndex = textureImageIndexMap.get(tex);
    // find the texture definition that uses this image and add the extension
    for (const def of textureDefinitions) {
        if (def.source === imageIndex) {
            return def;
        }
    }
}
exports.getTextureDefinition = getTextureDefinition;
